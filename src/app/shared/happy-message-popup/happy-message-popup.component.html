<div *ngIf="aberto" class="modal-geral" role="dialog" [attr.aria-modal]="aberto ? 'true' : 'false'">
  <div class="modal-bg" (click)="closePopup()"></div>

  <div class="modal-wrapper">
      <div class="modal-box">
        <div class="birthday-content">
          <button class="modal-close" (click)="closePopup()">×</button>
         <div class="birthday-icon">
            <svg viewBox="0 0 72 72" preserveAspectRatio="xMidYMid slice"
                 style="position:absolute; inset:0; width:100%; height:100%; pointer-events:none; z-index:0;">
              <!-- Confetti pieces: diferentes cores, tempos e posições -->
              <rect x="8" y="-8" width="4" height="8" fill="#F94144" opacity="0.95">
                <animate attributeName="y" from="-12" to="84" dur="1.8s" repeatCount="indefinite" begin="0s" />
                <animateTransform attributeName="transform" type="rotate" from="0 10 10" to="360 10 10" dur="1.8s" repeatCount="indefinite" />
              </rect>

              <rect x="18" y="-10" width="3" height="6" fill="#F3722C" opacity="0.95">
                <animate attributeName="y" from="-14" to="84" dur="2.1s" repeatCount="indefinite" begin="0.2s" />
                <animateTransform attributeName="transform" type="rotate" from="0 19 10" to="-360 19 10" dur="2.1s" repeatCount="indefinite" />
              </rect>

              <rect x="28" y="-6" width="5" height="7" fill="#F9C74F" opacity="0.95">
                <animate attributeName="y" from="-10" to="84" dur="1.6s" repeatCount="indefinite" begin="0.4s" />
                <animateTransform attributeName="transform" type="rotate" from="0 30 10" to="360 30 10" dur="1.6s" repeatCount="indefinite" />
              </rect>

              <rect x="38" y="-12" width="4" height="9" fill="#90BE6D" opacity="0.95">
                <animate attributeName="y" from="-16" to="84" dur="2.3s" repeatCount="indefinite" begin="0.6s" />
                <animateTransform attributeName="transform" type="rotate" from="0 40 10" to="-360 40 10" dur="2.3s" repeatCount="indefinite" />
              </rect>

              <rect x="48" y="-9" width="3" height="6" fill="#577590" opacity="0.95">
                <animate attributeName="y" from="-13" to="84" dur="1.9s" repeatCount="indefinite" begin="0.8s" />
                <animateTransform attributeName="transform" type="rotate" from="0 50 10" to="360 50 10" dur="1.9s" repeatCount="indefinite" />
              </rect>

              <circle cx="58" cy="-8" r="3" fill="#B5179E" opacity="0.95">
                <animate attributeName="cy" from="-14" to="84" dur="2s" repeatCount="indefinite" begin="0.3s" />
                <animateTransform attributeName="transform" type="rotate" from="0 58 10" to="-360 58 10" dur="2s" repeatCount="indefinite" />
              </circle>

              <rect x="12" y="-7" width="3" height="6" fill="#06D6A0" opacity="0.95">
                <animate attributeName="y" from="-12" to="84" dur="2.2s" repeatCount="indefinite" begin="1s" />
                <animateTransform attributeName="transform" type="rotate" from="0 14 10" to="360 14 10" dur="2.2s" repeatCount="indefinite" />
              </rect>
            </svg>

            <img [src]="icon" alt="Badge" />
          </div>

          <div class="birthday-text">
            <h1 class="user-name" >{{initialMessage}}</h1>
            <p class="birthday-message" [ngStyle]="tipo === '3m' ? estiloMensagem3Meses : {}" [innerHTML]="finalMessage"></p>
          </div>

          <button class="birthday-cta" (click)="closePopup()"><span class="textbtn">Vou com tudo<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M14.1925 10.4425L7.94254 16.6925C7.88447 16.7506 7.81553 16.7967 7.73966 16.8281C7.66379 16.8595 7.58247 16.8757 7.50035 16.8757C7.41823 16.8757 7.33691 16.8595 7.26104 16.8281C7.18517 16.7967 7.11623 16.7506 7.05816 16.6925C7.00009 16.6345 6.95403 16.5655 6.9226 16.4897C6.89117 16.4138 6.875 16.3325 6.875 16.2503C6.875 16.1682 6.89117 16.0869 6.9226 16.011C6.95403 15.9352 7.00009 15.8662 7.05816 15.8082L12.8668 10.0003L7.05816 4.19253C6.94088 4.07526 6.875 3.9162 6.875 3.75035C6.875 3.5845 6.94088 3.42544 7.05816 3.30816C7.17544 3.19088 7.3345 3.125 7.50035 3.125C7.6662 3.125 7.82526 3.19088 7.94254 3.30816L14.1925 9.55816C14.2506 9.61621 14.2967 9.68514 14.3282 9.76101C14.3597 9.83688 14.3758 9.91821 14.3758 10.0003C14.3758 10.0825 14.3597 10.1638 14.3282 10.2397C14.2967 10.3156 14.2506 10.3845 14.1925 10.4425Z" fill="#F6F8FE"/>
          </svg>
            </span>
          </button>
        </div>
    </div>
  </div>
</div>
