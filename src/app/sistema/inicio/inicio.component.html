<div class="container pt-5">
  <div class="container mt-4">
    <!-- Aviso de Cadastro Incompleto -->
    <div *ngIf="mostrarAvisoCadastro" class="aviso-cadastro">
      <div class="aviso-content">
        <div class="aviso-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" fill="currentColor"/>
          </svg>
        </div>
        <div class="aviso-text">
          <strong>Complete seu cadastro!</strong>
          <p>Para uma melhor experiÃªncia, complete as informaÃ§Ãµes do seu perfil.</p>
        </div>
        <button class="btn-completar" (click)="irParaPerfil()">
          Completar Agora
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button class="btn-fechar" (click)="fecharAvisoCadastro()" aria-label="Fechar aviso">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 5L5 15M5 5l10 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="header">
      <h1 class="welcome-message">ðŸ‘‹ Seja Bem-vindo(a), {{ nomeUsuario }}</h1>
      <div class="filtro-select">
        <app-select-padrao
          [options]="opcoesFiltro"
          [selectedValue]="filtroSelecionado"
          [label]="'Filtrar por'"
          (selectedValueChange)="onFiltroSelecionado($event)"
          placeholder="Filtrar por"
        ></app-select-padrao>
      </div>
    </div>
    <div class="container-principal">
      <div class="container-esquerda">
        <div class="banner-trilha">
          <div class="banner-text">
            <h2>Revise seus estudos e aprenda como nunca antes!</h2>
            <p>Crie sua programaÃ§Ã£o de estudos e conquiste novos resultados.</p>
          </div>
          <button
            class="banner-button"
            (click)="abrirModalConfiguracaoTrilha()"
          >
            Criar minha trilha de revisÃµes
            <img src="assets/Icons/arrow-updown.svg" alt="seta" />
          </button>
        </div>
        <div class="estatisticas">
          <div class="card-estatistica">
            <img
              [src]="
                isDarkMode()
                  ? 'assets/Icons/dark/v-dark.svg'
                  : 'assets/Icons/v.svg'
              "
              alt="Ãcone de Respostas Certas"
            />
            <div class="card-text-estatistica">
              <h3>{{ respostasCertas }}</h3>
              <p>Respostas Certas</p>
            </div>
          </div>
          <div class="card-estatistica">
            <img
              [src]="
                isDarkMode()
                  ? 'assets/Icons/dark/x-dark.svg'
                  : 'assets/Icons/x.svg'
              "
              alt="Ãcone de Respostas Erradas"
            />
            <div class="card-text-estatistica">
              <h3>{{ respostasErradas }}</h3>
              <p>Respostas Erradas</p>
            </div>
          </div>
          <div class="card-estatistica">
            <img
              [src]="
                isDarkMode()
                  ? 'assets/Icons/dark/au-ofi-dark.svg'
                  : 'assets/Icons/au-ofi.svg'
              "
              alt="Ãcone de Aulas"
            />
            <div class="card-text-estatistica">
              <h3>{{ aulasAssistidas }}</h3>
              <p>Aulas Assistidas</p>
            </div>
          </div>
          <div class="card-estatistica">
            <img
              [src]="
                isDarkMode()
                  ? 'assets/Icons/dark/flashcards-dark.svg'
                  : 'assets/Icons/flashcards.svg'
              "
              alt="Ãcone de Flashcards"
            />
            <div class="card-text-estatistica">
              <h3>{{ flashcardsEstudados }}</h3>
              <p>Flashcards Estudados</p>
            </div>
          </div>
        </div>
      </div>
      <div class="container-direita">
        <div class="card-ofensiva">
          <div *ngIf="isLoadingOfensiva; else ofensivaContent">
            <app-loading-simple></app-loading-simple>
          </div>
          <ng-template #ofensivaContent>
            <div *ngIf="dadosOfensiva">
              <div class="ofensiva-header">
                <span class="ofensiva-dias">{{
                  dadosOfensiva.ofensivaAtual
                }}</span>
                <img
                  src="assets/Icons/raio.svg"
                  alt="Ofensiva"
                  class="ofensiva-raio"
                />
                <p class="ofensiva-titulo">dia(s) de ofensiva</p>
              </div>

              <div class="dias-semana-ofensiva">
                <div
                  class="dia-circulo"
                  [class.active]="dadosOfensiva.diasDaSemana.includes('SEG')"
                >
                  Seg
                </div>
                <div
                  class="dia-circulo"
                  [class.active]="dadosOfensiva.diasDaSemana.includes('TER')"
                >
                  Ter
                </div>
                <div
                  class="dia-circulo"
                  [class.active]="dadosOfensiva.diasDaSemana.includes('QUA')"
                >
                  Qua
                </div>
                <div
                  class="dia-circulo"
                  [class.active]="dadosOfensiva.diasDaSemana.includes('QUI')"
                >
                  Qui
                </div>
                <div
                  class="dia-circulo"
                  [class.active]="dadosOfensiva.diasDaSemana.includes('SEX')"
                >
                  Sex
                </div>
                <div
                  class="dia-circulo"
                  [class.active]="dadosOfensiva.diasDaSemana.includes('SAB')"
                >
                  SÃ¡b
                </div>
                <div
                  class="dia-circulo"
                  [class.active]="dadosOfensiva.diasDaSemana.includes('DOM')"
                >
                  Dom
                </div>
              </div>

              <p class="ofensiva-footer-text">
                Continue acessando o Oftlessons diariamente para manter sua
                ofensiva!
              </p>

              <div class="foto-robo">
                <img
                  src="..//../..//assets/imagens/robo-ofensiva.png"
                  alt="Robo Ofensiva"
                />
              </div>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
  <div class="section">
    <h2>Principais recursos para vocÃª</h2>
    <div class="container-row">
      <div class="mb-4" *ngIf="possuiPermissao">
        <div class="card">
          <div class="card-body text-center">
            <h5 class="card-title">QuestÃµes</h5>
            <div class="card-icon">
              <img
                src="assets/Icons/dark/caderno-dark.svg"
                alt="Ãcone de QuestÃµes"
                class="icon"
              />
            </div>
            <a routerLink="/usuario/questoes" class="btn btn-primary">
              Acessar >
            </a>
          </div>
        </div>
      </div>

      <div class="mb-4" *ngIf="possuiPermissao">
        <div class="card">
          <div class="card-body text-center">
            <h5 class="card-title">Simulados</h5>
            <div class="card-icon">
              <img
                src="assets/Icons/dark/simu-dark.svg"
                alt="Ãcone de Simulados"
                class="icon"
              />
            </div>
            <a routerLink="/usuario/simulados" class="btn btn-primary">
              Acessar >
            </a>
          </div>
        </div>
      </div>

      <div class="mb-4">
        <div class="card">
          <div class="card-body text-center">
            <h5 class="card-title">Flashcards</h5>
            <div class="card-icon">
              <img
                src="assets/Icons/dark/flashcards-dark.svg"
                alt="Ãcone de Flashcard"
                class="icon"
              />
            </div>
            <button (click)="redirecionarFlashcard()" class="btn btn-primary">
              Acessar >
            </button>
            <!--
              <div *ngIf="mostrarMensagemFlashcard" class="mensagem">
                Em breve novas funcionalidades disponÃ­veis para vocÃª ðŸ˜ƒ.
              </div>
                -->
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="section">
    <h2>Pesquisa de SatisfaÃ§Ã£o</h2>
    <div class="container-row">
      <div class="mb-4">
        <div class="card satisfacao">
          <div class="card-body text-center">
            <h5 class="card-title">Pesquisa de SatisfaÃ§Ã£o</h5>
            <div class="card-icon">
              <img
                src="assets/Icons/pes.svg"
                alt="Ãcone de Pesquisa"
                class="icon"
                style="width: 50px; height: 50px"
              />
            </div>
            <a
              href="https://forms.gle/owp46GkkmZDNq4sq9"
              class="btn btn-primary btn-pesquisa"
              target="_blank"
              rel="noopener noreferrer"
            >
              Acessar >
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  class="modal-overlay"
  *ngIf="modalTrilhaAberto || modalConfirmacaoAberto || mostrarModalOfensiva"
>
  <div class="modal-trilha" *ngIf="modalTrilhaAberto">
    <div class="modal-header">
      <h2>Configurar minha programaÃ§Ã£o de revisÃµes</h2>
      <button class="btn-close" (click)="modalTrilhaAberto = false">
        &times;
      </button>
    </div>

    <div class="modal-body">
      <div class="form-group">
        <label>Quais dias vocÃª quer revisar? *</label>
        <div class="dias-semana">
          <button
            class="btn-dia"
            [ngClass]="{ selected: verificarDiaSelecionado('Segunda') }"
            (click)="toggleDiaSelecionado('Segunda')"
          >
            Segunda
          </button>
          <button
            class="btn-dia"
            [ngClass]="{ selected: verificarDiaSelecionado('TerÃ§a') }"
            (click)="toggleDiaSelecionado('TerÃ§a')"
          >
            TerÃ§a
          </button>
          <button
            class="btn-dia"
            [ngClass]="{ selected: verificarDiaSelecionado('Quarta') }"
            (click)="toggleDiaSelecionado('Quarta')"
          >
            Quarta
          </button>
          <button
            class="btn-dia"
            [ngClass]="{ selected: verificarDiaSelecionado('Quinta') }"
            (click)="toggleDiaSelecionado('Quinta')"
          >
            Quinta
          </button>
          <button
            class="btn-dia"
            [ngClass]="{ selected: verificarDiaSelecionado('Sexta') }"
            (click)="toggleDiaSelecionado('Sexta')"
          >
            Sexta
          </button>
          <button
            class="btn-dia"
            [ngClass]="{ selected: verificarDiaSelecionado('SÃ¡bado') }"
            (click)="toggleDiaSelecionado('SÃ¡bado')"
          >
            SÃ¡bado
          </button>
          <button
            class="btn-dia"
            [ngClass]="{ selected: verificarDiaSelecionado('Domingo') }"
            (click)="toggleDiaSelecionado('Domingo')"
          >
            Domingo
          </button>
        </div>
      </div>

      <div class="form-group">
        <label
          >Defina quanto tempo vocÃª quer dedicar Ã  revisÃ£o nesses dias? *</label
        >
        <div class="tempo-container">
          <div class="tempo-input">
            <label>Horas</label>
            <input
              type="number"
              min="0"
              [(ngModel)]="horasDedicadas"
              placeholder="0 h"
            />
          </div>
          <div class="tempo-input">
            <label>Minutos</label>
            <input
              type="number"
              min="0"
              max="59"
              [(ngModel)]="minutosDedicados"
              placeholder="0 min"
            />
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>Data da tÃ©rmino</label>
        <input type="date" [(ngModel)]="dataTermino" class="data-input" />
      </div>

      <div class="form-group">
        <label>Assunto(s) que vocÃª deseja revisar</label>
        <app-multiplo-select
          [options]="assuntosDisponiveis"
          [selectedValue]="assuntosSelecionados"
          label="Assuntos"
          [multiple]="true"
          placeholder="Selecione os assuntos"
        ></app-multiplo-select>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-cancel" (click)="fecharModalConfiguracaoTrilha()">
        Cancelar
      </button>
      <button class="btn btn-save" (click)="salvarConfiguracoesTrilha()">
        Salvar
      </button>
    </div>
  </div>

  <div
    class="modal-trilha modal-ofensiva"
    *ngIf="mostrarModalOfensiva && dadosOfensiva"
  >
    <div class="modal-header">
      <h2></h2>
      <button class="btn-close" (click)="fecharModalOfensiva()">&times;</button>
    </div>

    <div class="modal-body-ofensiva">
      <div class="ofensiva-header">
        <span class="ofensiva-dias">{{ dadosOfensiva!.ofensivaAtual }}</span>
        <img
          src="..//..//..//assets/videos/raio-ofensiva.gif"
          alt="Ofensiva"
          class="ofensiva-raio"
        />
      </div>
      <p class="ofensiva-titulo">dia(s) de ofensiva</p>

      <div class="dias-semana-ofensiva">
        <div class="dia-item">
          <div
            class="dia-circulo"
            [class.active]="dadosOfensiva!.diasDaSemana.includes('SEG')"
          ></div>
          <span class="dia-nome">Seg</span>
        </div>

        <div class="dia-item">
          <div
            class="dia-circulo"
            [class.active]="dadosOfensiva!.diasDaSemana.includes('TER')"
          ></div>
          <span class="dia-nome">Ter</span>
        </div>

        <div class="dia-item">
          <div
            class="dia-circulo"
            [class.active]="dadosOfensiva!.diasDaSemana.includes('QUA')"
          ></div>
          <span class="dia-nome">Qua</span>
        </div>

        <div class="dia-item">
          <div
            class="dia-circulo"
            [class.active]="dadosOfensiva!.diasDaSemana.includes('QUI')"
          ></div>
          <span class="dia-nome">Qui</span>
        </div>

        <div class="dia-item">
          <div
            class="dia-circulo"
            [class.active]="dadosOfensiva!.diasDaSemana.includes('SEX')"
          ></div>
          <span class="dia-nome">Sex</span>
        </div>

        <div class="dia-item">
          <div
            class="dia-circulo"
            [class.active]="dadosOfensiva!.diasDaSemana.includes('SAB')"
          ></div>
          <span class="dia-nome">SÃ¡b</span>
        </div>

        <div class="dia-item">
          <div
            class="dia-circulo"
            [class.active]="dadosOfensiva!.diasDaSemana.includes('DOM')"
          ></div>
          <span class="dia-nome">Dom</span>
        </div>
      </div>

      <p class="ofensiva-footer-text">
        Continue acessando o Oftlessons diariamente para manter sua ofensiva!
      </p>
    </div>

    <div class="modal-footer-ofensiva">
      <button class="btn btn-save btn-verde" (click)="fecharModalOfensiva()">
        Vou com tudo
        <img src="../../../assets/Icons/setaDireta.svg" alt="seta" />
      </button>
    </div>
  </div>

  <div class="modal-trilha" *ngIf="modalConfirmacaoAberto">
    <div class="modal-body-comecar">
      <div class="animation"></div>
      <div class="modal-text-comecar">
        <h2>O comeÃ§o de uma trilha feita para vocÃª!</h2>
        <p>
          DÃª os primeiros passos e prepare o caminho para sua trilha de revisÃµes
          personalizadas.
        </p>
      </div>
    </div>
    <div class="modal-footer-comecar">
      <button class="btn btn-cancel" (click)="fecharModalConfirmacao()">
        Iniciar mais tarde
      </button>
      <button class="btn btn-comecar" (click)="iniciarTrilhaAgora()">
        ComeÃ§ar agora
        <img src="assets/Icons/arrow-updown.svg" alt="seta" />
      </button>
    </div>
  </div>
</div>
